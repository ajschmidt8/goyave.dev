(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{474:function(t,s,a){"use strict";a.r(s);var n=a(34),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"filter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#filter"}},[t._v("#")]),t._v(" Filter")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/go-goyave/filter",target:"_blank",rel:"noopener noreferrer"}},[t._v("Link to repository"),a("OutboundLink")],1)]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#usage"}},[t._v("Usage")]),a("ul",[a("li",[a("a",{attrs:{href:"#settings"}},[t._v("Settings")])]),a("li",[a("a",{attrs:{href:"#filter"}},[t._v("Filter")])]),a("li",[a("a",{attrs:{href:"#fields-select"}},[t._v("Fields / Select")])]),a("li",[a("a",{attrs:{href:"#sort"}},[t._v("Sort")])]),a("li",[a("a",{attrs:{href:"#join"}},[t._v("Join")])]),a("li",[a("a",{attrs:{href:"#pagination"}},[t._v("Pagination")])])])]),a("li",[a("a",{attrs:{href:"#security"}},[t._v("Security")])]),a("li",[a("a",{attrs:{href:"#model-recommendations"}},[t._v("Model recommendations")])])])]),a("p"),t._v(" "),a("p",[a("code",[t._v("goyave.dev/filter")]),t._v(" allows powerful filtering using query parameters. Inspired by "),a("a",{attrs:{href:"https://github.com/nestjsx/crud/wiki/Requests",target:"_blank",rel:"noopener noreferrer"}},[t._v("nestjsx/crud"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p",[a("strong",[t._v("Minimum Goyave version: "),a("code",[t._v("v4.0.0")])])]),t._v(" "),a("h2",{attrs:{id:"usage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[t._v("#")]),t._v(" Usage")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("go get goyave.dev/filter\n")])])]),a("p",[t._v("First, apply filters validation to the "),a("code",[t._v("RuleSet")]),t._v(" used on the routes you wish the filters on.")]),t._v(" "),a("div",{staticClass:"language-go extra-class"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"goyave.dev/filter"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\tIndexRequest "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" validation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RuleSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tfilter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ApplyValidation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("IndexRequest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"language-go extra-class"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[t._v("router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/users"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Validate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IndexRequest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("Then implement your controller handler:")]),t._v(" "),a("div",{staticClass:"language-go extra-class"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"goyave.dev/filter"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("goyave"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("goyave"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" users "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("User\n\tpaginator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Scope")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("database"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetConnection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("HandleDatabaseError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tresponse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StatusOK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" paginator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("And "),a("strong",[t._v("that's it")]),t._v("! Now your front-end can add query parameters to filter as it wants.")]),t._v(" "),a("h3",{attrs:{id:"settings"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#settings"}},[t._v("#")]),t._v(" Settings")]),t._v(" "),a("p",[t._v("You can disable certain features, or blacklist certain fields using "),a("code",[t._v("filter.Settings")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-go extra-class"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[t._v("settings "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tDisableFields"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Prevent usage of "fields"')]),t._v("\n\tDisableFilter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Prevent usage of "filter"')]),t._v("\n\tDisableSort"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Prevent usage of "sort"')]),t._v("\n\tDisableJoin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Prevent usage of "join"')]),t._v("\n\n\tBlacklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Blacklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Prevent selecting, sorting and filtering on these fields")]),t._v("\n\t\tFieldsBlacklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"b"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Prevent joining these relations")]),t._v("\n\t\tRelationsBlacklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Relation"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n\t\tRelations"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Blacklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Blacklist settings to apply to this relation")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Relation"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Blacklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\tFieldsBlacklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"c"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"d"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t\tRelationsBlacklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Parent"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t\tRelations"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Blacklist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*...*/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t\tIsFinal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("            "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Prevent joining any child relation if true")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\npaginator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Scope")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("database"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetConnection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("results"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"filter-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#filter-2"}},[t._v("#")]),t._v(" Filter")]),t._v(" "),a("blockquote",[a("p",[t._v("?filter="),a("strong",[t._v("field")]),t._v("||"),a("strong",[t._v("$operator")]),t._v("||"),a("strong",[t._v("value")])])]),t._v(" "),a("p",[a("em",[t._v("Examples:")])]),t._v(" "),a("blockquote",[a("p",[t._v("?filter="),a("strong",[t._v("name")]),t._v("||"),a("strong",[t._v("$cont")]),t._v("||"),a("strong",[t._v("Jack")]),t._v(" ("),a("code",[t._v("WHERE name LIKE %Jack%")]),t._v(")")])]),t._v(" "),a("p",[t._v("You can add multiple filters. In that case, it is interpreted as an "),a("code",[t._v("AND")]),t._v(" condition.")]),t._v(" "),a("p",[t._v("You can use "),a("code",[t._v("OR")]),t._v(" conditions using "),a("code",[t._v("?or")]),t._v(" instead, or in combination:")]),t._v(" "),a("blockquote",[a("p",[t._v("?filter="),a("strong",[t._v("name")]),t._v("||"),a("strong",[t._v("$cont")]),t._v("||"),a("strong",[t._v("Jack")]),t._v("&or="),a("strong",[t._v("name")]),t._v("||"),a("strong",[t._v("$cont")]),t._v("||"),a("strong",[t._v("John")]),t._v("  ("),a("code",[t._v("WHERE name LIKE %Jack% OR name LIKE %John%")]),t._v(")"),a("br"),t._v("\n?filter="),a("strong",[t._v("age")]),t._v("||"),a("strong",[t._v("$eq")]),t._v("||"),a("strong",[t._v("50")]),t._v("&filter="),a("strong",[t._v("name")]),t._v("||"),a("strong",[t._v("$cont")]),t._v("||"),a("strong",[t._v("Jack")]),t._v("&or="),a("strong",[t._v("name")]),t._v("||"),a("strong",[t._v("$cont")]),t._v("||"),a("strong",[t._v("John")]),t._v(" ("),a("code",[t._v("WHERE age = 50 AND name LIKE %Jack% OR name LIKE %John%")]),t._v(")")])]),t._v(" "),a("p",[t._v('You can filter using columns from one-to-one relations ("has one" or "belongs to"):')]),t._v(" "),a("blockquote",[a("p",[t._v("?filter="),a("strong",[t._v("Relation.name")]),t._v("||"),a("strong",[t._v("$cont")]),t._v("||"),a("strong",[t._v("Jack")])])]),t._v(" "),a("h4",{attrs:{id:"operators"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#operators"}},[t._v("#")]),t._v(" Operators")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th")])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[a("code",[t._v("$eq")])])]),t._v(" "),a("td",[a("code",[t._v("=")]),t._v(", equals")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$ne")])])]),t._v(" "),a("td",[a("code",[t._v("<>")]),t._v(", not equals")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$gt")])])]),t._v(" "),a("td",[a("code",[t._v(">")]),t._v(", greater than")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$lt")])])]),t._v(" "),a("td",[a("code",[t._v("<")]),t._v(", lower than")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$gte")])])]),t._v(" "),a("td",[a("code",[t._v(">=")]),t._v(", greater than or equals")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$lte")])])]),t._v(" "),a("td",[a("code",[t._v("<=")]),t._v(", lower than or equals")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$starts")])])]),t._v(" "),a("td",[a("code",[t._v("LIKE val%")]),t._v(", starts with")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$ends")])])]),t._v(" "),a("td",[a("code",[t._v("LIKE %val")]),t._v(", ends with")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$cont")])])]),t._v(" "),a("td",[a("code",[t._v("LIKE %val%")]),t._v(", contains")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$excl")])])]),t._v(" "),a("td",[a("code",[t._v("NOT LIKE %val%")]),t._v(", not contains")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$in")])])]),t._v(" "),a("td",[a("code",[t._v("IN (val1, val2,...)")]),t._v(", in (accepts multiple values)")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$notin")])])]),t._v(" "),a("td",[a("code",[t._v("NOT IN (val1, val2,...)")]),t._v(", in (accepts multiple values)")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$isnull")])])]),t._v(" "),a("td",[a("code",[t._v("IS NULL")]),t._v(", is NULL (doesn't accept value)")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$notnull")])])]),t._v(" "),a("td",[a("code",[t._v("IS NOT NULL")]),t._v(", not NULL (doesn't accept value)")])]),t._v(" "),a("tr",[a("td",[a("strong",[a("code",[t._v("$between")])])]),t._v(" "),a("td",[a("code",[t._v("BETWEEN val1 AND val2")]),t._v(", between (accepts two values)")])])])]),t._v(" "),a("h3",{attrs:{id:"fields-select"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fields-select"}},[t._v("#")]),t._v(" Fields / Select")]),t._v(" "),a("blockquote",[a("p",[t._v("?fields="),a("strong",[t._v("field1")]),t._v(","),a("strong",[t._v("field2")])])]),t._v(" "),a("p",[t._v("A comma-separated list of fields to select. If this field isn't provided, uses "),a("code",[t._v("SELECT *")]),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"sort"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sort"}},[t._v("#")]),t._v(" Sort")]),t._v(" "),a("blockquote",[a("p",[t._v("?sort="),a("strong",[t._v("column")]),t._v(","),a("strong",[t._v("ASC")]),t._v("|"),a("strong",[t._v("DESC")])])]),t._v(" "),a("p",[a("em",[t._v("Examples:")])]),t._v(" "),a("blockquote",[a("p",[t._v("?sort="),a("strong",[t._v("name")]),t._v(","),a("strong",[t._v("ASC")]),a("br"),t._v("\n?sort="),a("strong",[t._v("age")]),t._v(","),a("strong",[t._v("DESC")])])]),t._v(" "),a("p",[t._v("You can also sort by multiple fields.")]),t._v(" "),a("blockquote",[a("p",[t._v("?sort="),a("strong",[t._v("age")]),t._v(","),a("strong",[t._v("DESC")]),t._v("&sort="),a("strong",[t._v("name")]),t._v(","),a("strong",[t._v("ASC")])])]),t._v(" "),a("h3",{attrs:{id:"join"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#join"}},[t._v("#")]),t._v(" Join")]),t._v(" "),a("blockquote",[a("p",[t._v("?join="),a("strong",[t._v("relation")])])]),t._v(" "),a("p",[t._v("Preload a relation. You can also only select the columns you need:")]),t._v(" "),a("blockquote",[a("p",[t._v("?join="),a("strong",[t._v("relation")]),t._v("||"),a("strong",[t._v("field1")]),t._v(","),a("strong",[t._v("field2")])])]),t._v(" "),a("p",[t._v("You can join multiple relations:")]),t._v(" "),a("blockquote",[a("p",[t._v("?join="),a("strong",[t._v("profile")]),t._v("||"),a("strong",[t._v("firstName")]),t._v(","),a("strong",[t._v("email")]),t._v("&join="),a("strong",[t._v("notifications")]),t._v("||"),a("strong",[t._v("content")]),t._v("&join="),a("strong",[t._v("tasks")])])]),t._v(" "),a("h3",{attrs:{id:"pagination"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pagination"}},[t._v("#")]),t._v(" Pagination")]),t._v(" "),a("p",[t._v("Internally, "),a("code",[t._v("goyave.dev/filter")]),t._v(" uses "),a("RouterLink",{attrs:{to:"/guide/basics/database.html#pagination"}},[t._v("Goyave's "),a("code",[t._v("Paginator")])]),t._v(".")],1),t._v(" "),a("blockquote",[a("p",[t._v("?page="),a("strong",[t._v("1")]),t._v("&per_page="),a("strong",[t._v("10")])])]),t._v(" "),a("ul",[a("li",[t._v("If "),a("code",[t._v("page")]),t._v(" isn't given, the first page will be returned.")]),t._v(" "),a("li",[t._v("If "),a("code",[t._v("per_page")]),t._v(" isn't given, the default page size will be used. This default value can be overridden by changing "),a("code",[t._v("filter.DefaultPageSize")]),t._v(".")]),t._v(" "),a("li",[t._v("Either way, the result is "),a("strong",[t._v("always")]),t._v(" paginated, even if those two parameters are missing.")])]),t._v(" "),a("h2",{attrs:{id:"security"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#security"}},[t._v("#")]),t._v(" Security")]),t._v(" "),a("ul",[a("li",[t._v("Inputs are escaped to prevent SQL injections.")]),t._v(" "),a("li",[t._v("Fields are pre-processed and clients cannot request fields that don't exist. This prevents database errors. If a non-existing field is required, it is simply ignored. The same goes for sorts and joins. It is not possible to request a relation that doesn't exist.")]),t._v(" "),a("li",[t._v("Foreign keys are always selected in joins to ensure associations can be assigned to parent model.")]),t._v(" "),a("li",[a("strong",[t._v("Be careful")]),t._v(" with bidirectional relations (for example an article is written by a user, and a user can have many articles). If you enabled both your models to preload these relations, the client can request them with an infinite depth ("),a("code",[t._v("Articles.User.Articles.User...")]),t._v("). To prevent this, it is advised to use "),a("strong",[t._v("the relation blacklist")]),t._v(" or "),a("strong",[t._v("IsFinal")]),t._v(" on the deepest requestable models. See the settings section for more details.")])]),t._v(" "),a("h2",{attrs:{id:"model-recommendations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#model-recommendations"}},[t._v("#")]),t._v(" Model recommendations")]),t._v(" "),a("ul",[a("li",[t._v("Use "),a("code",[t._v('json:",omitempty"')]),t._v(" on all model fields.\n"),a("ul",[a("li",[a("em",[t._v("Note: using "),a("code",[t._v("omitempty")]),t._v(" on slices will remove them from the json result if they are not nil and empty. There is currently no solution to this problem using the standard json package.")])])])]),t._v(" "),a("li",[t._v("Use "),a("code",[t._v('json:"-"')]),t._v(" on foreign keys.")]),t._v(" "),a("li",[t._v("Use "),a("code",[t._v("*null.Time")]),t._v(" from the "),a("a",{attrs:{href:"https://github.com/guregu/null",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("gopkg.in/guregu/null.v4")]),a("OutboundLink")],1),t._v(" library instead of "),a("code",[t._v("sql.NullTime")]),t._v(".")]),t._v(" "),a("li",[t._v("Always specify "),a("code",[t._v('gorm:"foreignKey"')]),t._v(', otherwise falls back to "ID".')]),t._v(" "),a("li",[t._v("Don't use "),a("code",[t._v("gorm.Model")]),t._v(" and add the necessary fields manually. You get better control over json struct tags this way.")]),t._v(" "),a("li",[t._v("Use pointers for nullable relations and nullable fields that implement "),a("code",[t._v("sql.Scanner")]),t._v(" (such as "),a("code",[t._v("null.Time")]),t._v(").")])])])}),[],!1,null,null,null);s.default=e.exports}}]);